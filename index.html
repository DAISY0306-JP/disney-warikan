<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>å‰²ã‚Šå‹˜ã‚¢ãƒ—ãƒª</title>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 15px;
}
.container { max-width: 800px; margin: 0 auto; }

.card {
    background: white;
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    margin-bottom: 15px;
}

h1 { font-size: 22px; margin-bottom: 10px; }
h2 { font-size: 18px; margin-bottom: 10px; }

.btn {
    padding: 12px 18px;
    border: none;
    border-radius: 10px;
    background: #667eea;
    color: white;
    cursor: pointer;
    font-weight: 600;
    margin-top: 10px;
}
.btn-danger { background: #f56565; }
.btn-secondary { background: #48bb78; }

.input-group { margin-bottom: 12px; }
.input-group input,
.input-group select {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ddd;
}

.summary-card {
    background: #f7fafc;
    padding: 10px;
    border-radius: 8px;
    margin-bottom: 8px;
}
.settlement-item {
    background: #f7fafc;
    padding: 10px;
    border-radius: 8px;
    margin-bottom: 8px;
    display:flex;
    justify-content:space-between;
}
.deposit-section {
    background: #fffbeb;
    padding: 10px;
    border-radius: 10px;
    margin-bottom: 15px;
    border: 1px solid #fbbf24;
}
</style>
</head>

<body>
<div class="container">

<div class="card">
<h1>ğŸ’° å‰²ã‚Šå‹˜ã‚¢ãƒ—ãƒª</h1>

<div class="input-group">
<label>ãƒ¡ãƒ³ãƒãƒ¼ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</label>
<input type="text" id="memberInput" placeholder="ä¾‹: ã‚ã‚„ã‹, ã¿ã‹ã“, ã•ã‚„ã‹">
</div>

<button class="btn" onclick="setMembers()">ãƒ¡ãƒ³ãƒãƒ¼ç¢ºå®š</button>
</div>


<div class="card">
<h2>ğŸ’µ é ã‹ã‚Šé‡‘</h2>

<div class="input-group">
<label>é ã‹ã£ãŸäºº</label>
<select id="depositHolder"></select>
</div>

<div class="input-group">
<label>é ã‘ãŸäºº</label>
<select id="depositFrom"></select>
</div>

<div class="input-group">
<label>é‡‘é¡</label>
<input type="number" id="depositAmount">
</div>

<button class="btn" onclick="addDeposit()">è¿½åŠ </button>

<div id="depositSummary"></div>
</div>


<div class="card">
<h2>ğŸ’³ æ”¯æ‰•ã„è¨˜éŒ²</h2>

<div class="input-group">
<label>æ”¯æ‰•ã£ãŸäºº</label>
<select id="paidBy"></select>
</div>

<div class="input-group">
<label>é‡‘é¡</label>
<input type="number" id="expenseAmount">
</div>

<button class="btn" onclick="addExpense()">è¿½åŠ </button>

<div id="settlementSummary"></div>
</div>

</div>

<script>
let members = [];
let expenses = [];
let deposits = [];

/* ===== ãƒ¡ãƒ³ãƒãƒ¼è¨­å®š ===== */
function setMembers(){
    const input = document.getElementById("memberInput").value;
    members = input.split(",").map(m => m.trim()).filter(Boolean);

    updateSelects();
}

/* ===== ã‚»ãƒ¬ã‚¯ãƒˆæ›´æ–° ===== */
function updateSelects(){
    const selects = ["depositHolder","depositFrom","paidBy"];
    selects.forEach(id=>{
        const select = document.getElementById(id);
        select.innerHTML="";
        members.forEach((m,i)=>{
            const opt=document.createElement("option");
            opt.value=i;
            opt.textContent=m;
            select.appendChild(opt);
        });
    });
}

/* ===== é ã‹ã‚Šé‡‘è¿½åŠ  ===== */
function addDeposit(){
    const holder = parseInt(document.getElementById("depositHolder").value);
    const from = parseInt(document.getElementById("depositFrom").value);
    const amount = parseFloat(document.getElementById("depositAmount").value);

    if(holder===from){ alert("åŒã˜äººã¯ä¸å¯"); return; }

    deposits.push({holder, from, amount});
    calculateSettlement();
}

/* ===== æ”¯æ‰•ã„è¿½åŠ  ===== */
function addExpense(){
    const paidBy = parseInt(document.getElementById("paidBy").value);
    const amount = parseFloat(document.getElementById("expenseAmount").value);

    expenses.push({paidBy, amount});
    calculateSettlement();
}

/* ================================
   ğŸ”¥ ã“ã“ãŒä»Šå›ã®æ ¸å¿ƒä¿®æ­£éƒ¨åˆ†
   é ã‹ã‚Šé‡‘ã¯æ®‹é«˜ã«æ··ãœãªã„
================================ */

function calculateSettlement(){

    const balances = Array(members.length).fill(0);

    // â‘  æ”¯å‡ºã®ã¿ã§æ®‹é«˜ã‚’è¨ˆç®—
    expenses.forEach(e=>{
        const share = e.amount / members.length;
        balances[e.paidBy] += e.amount;
        members.forEach((_,i)=>{
            balances[i] -= share;
        });
    });

    // ===== æ”¯å‡ºç²¾ç®—è¡¨ç¤º =====
    const s = document.getElementById("settlementSummary");
    s.innerHTML="<h3>æ”¯å‡ºç²¾ç®—</h3>";

    balances.forEach((b,i)=>{
        const div=document.createElement("div");
        div.className="summary-card";
        div.textContent = members[i] + " : " + Math.round(b);
        s.appendChild(div);
    });

    // ===== é ã‹ã‚Šé‡‘ã¯å›ºå®šè¿”é‡‘ =====
    const d = document.getElementById("depositSummary");
    d.innerHTML="<h3>é ã‹ã‚Šé‡‘è¿”é‡‘</h3>";

    deposits.forEach(dep=>{
        const div=document.createElement("div");
        div.className="settlement-item";
        div.textContent =
          members[dep.holder] + " â†’ " +
          members[dep.from] + " : " +
          dep.amount;
        d.appendChild(div);
    });
}
</script>
</body>
</html>